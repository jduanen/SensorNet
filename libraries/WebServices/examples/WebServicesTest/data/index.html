<!DOCTYPE HTML>
<html>
  <head>
    <title>%APPL_NAME% Web Server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="data:,">
    <link rel="stylesheet" type="text/css" href="/common/wsStyle.css">
  </head>
  <body>
    <div class="topnav">
      <h1>%APPL_NAME% Web Server</h1>
    </div>
    <div class="content">
      <div class="card">
        <h2>Common Information</h2>
        <p class="staticState">App Version: <span style="color:blue" id="version">%VERSION%</span></p>
        <p class="staticState">Library Version: <span style="color:blue" id="libVersion">%LIB_VERSION%</span></p>
        <p class="staticState">WIFI Mode: <span style="color:blue" id="wifiMode">%WIFI_MODE%</span></p>
        <p class="staticState">IP Address: <span style="color:blue" id="ipAddr">%IP_ADDR%</span></p>
        <p class="staticState">RSSI: <span style="color:blue" id="rssi">%RSSI%</span></p>
      </div>
      <br>
      <div class="card">
        <h2>Common Controls</h2>
        <div class="vertical-center" style="line-height: 1.5em;">
          <p>Update Firmware: <a href="update">Update</a></p>
          <p>
            SSID: <input type="text" id="ssid">
            <br>
            Password: <input type="password" id="password">
          </p>
        </div>
        <div class="vertical-center">
          <p><button class="green-button" id="save" onclick="saveConfiguration()">Save Configuration</button></p>
        </div>
      </div>
      <br>
      <nav>
      <a href="/appl">Application-Specific Information and Controls</a> |
      <a href="/update">Update Firmware</a>
      </nav>
    </div>
    <script src="/common/wsScripts.js"></script>
    <script>
      function initView() {
        var wifiMode = "%WIFI_MODE%";
        var elem;
        switch (wifiMode) {
          case "STA":
            elem = document.getElementById("ipAddr");
            if (elem == null) {
              var p1 = "<p class=\"staticState\">IP Address: <span style=\"color:blue\" id=\"ipAddr\">%IP_ADDR%</span></p>";
              document.getElementById("wifiMode").insertAdjacentHTML('afterend', p1);
            }
            elem = document.getElementById("connection");
            if (elem == null) {
              var p2 = "<p class=\"staticState\">Connection: <span style=\"color:blue\" id=\"connection\">%CONNECTION%</span></p>";
              document.getElementById("ipAddr").insertAdjacentHTML('afterend', p2);
            }
            break;
          case "A_P":
            elem = document.getElementById("wifiApSsid");
            if (elem == null) {
              var p1 = "<p class=\"staticState\">AP SSID: <span style=\"color:blue\" id=\"wifiApSsid\">%WIFI_AP_SSID%</span></p>";
              document.getElementById("wifiMode").insertAdjacentHTML('afterend', p1);
            }
            break;
          default:
            console.log("WARNING: invalid WIFI mode: " + wifiMode);
        }
        var jsonMsg = JSON.stringify({"msgType": "query"});
        websocket.send(jsonMsg);
      }
    </script>
  </body>
</html>
